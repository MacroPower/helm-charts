suite: controller types
templates:
  - common.yaml
tests:
  - it: default should pass
    asserts:
      - documentIndex: &ControllerDoc 0
        isKind:
          of: Deployment
      - documentIndex: *ControllerDoc
        equal:
          path: metadata.name
          value: RELEASE-NAME

  - it: daemonset should pass
    set:
      controller.type: daemonset
    asserts:
      - documentIndex: &ControllerDoc 0
        isKind:
          of: DaemonSet
      - documentIndex: *ControllerDoc
        equal:
          path: metadata.name
          value: RELEASE-NAME

  - it: statefulset should pass
    set:
      controller.type: statefulset
    asserts:
      - documentIndex: &ControllerDoc 0
        isKind:
          of: StatefulSet
      - documentIndex: *ControllerDoc
        equal:
          path: metadata.name
          value: RELEASE-NAME

  - it: cronjob should pass
    set:
      controller.type: cronjob
    asserts:
      - documentIndex: &ControllerDoc 0
        isKind:
          of: CronJob
      - documentIndex: *ControllerDoc
        equal:
          path: metadata.name
          value: RELEASE-NAME

  - it: disabled should pass
    set:
      controller.enabled: false
    asserts:
      - hasDocuments:
          count: 1
      - documentIndex: &ControllerDoc 0
        not: true
        isKind:
          of: StatefulSet
      - documentIndex: *ControllerDoc
        not: true
        isKind:
          of: DaemonSet
      - documentIndex: *ControllerDoc
        not: true
        isKind:
          of: Controller
